<p align="center"><img src="docs/logo.png" alt="Greenhouse Master"></p>
<br>
Greenhouse Master is a CMS, inventory system, online store, and greenhouse vitals log and display.  
Greenhouse Master is built from Django, Django Rest Framework, Wagtail, Snipcart, Charts.js, ESP8266 architecture, GPT-2, and supports MySQL, PostgreSQL, and SQLite databases.  The goal of the application is to provide an encompassing online presence and management system for greenhouse and nursery companies.
<br><br>
<p align="center"><img src="docs/homepage.png" alt="Homepage"></p>
<br>

## Features
* A fast, attractive user interface to make managing web content easy
* Automatically record and log temperature and humidity levels, changes, and averages in an easy-to-use dashboard
* Manage product inventory and online storefront, with sales reports generated by Snipcart
* Easily manage featured products, team members, and blog posts
* Powerful integrated search using ElasticSearch
* Generate keyword-friendly SEO content using a "prefix" and an ML model trained on over 15mb of online industry-related data (using GPT-2)


## Getting Started
Greenhouse Master works with Python 3 on any platform.
### Installation
To get started, run the following in a virtual environment:
1. `git clone https://github.com/JoeWHoward/Greenhouse-Master`
2. `cd Greenhouse-Master`
3. `pip install -r requirements.txt`
4. `python manage.py runserver`

### Usage
The default username is `admin` with a password of `admin`.
The admin login page is located at `/admin/`
You will need to update the Snipcart API key located in the Wagtail dashboard under Settings > Snipcart Settings for the shopping cart functionality to work.

# Discussion of Technologies Used
## Wagtail
[Wagtail](https://github.com/wagtail/wagtail) is an open-source CMS built on Django.  The functionality of Wagtail relies on the base model class of "Page".
### ModelAdmin
Django's admin dashboard exists as a separate entity from the Wagtail dashboard, though created users are shared.  This gives me two options, to divide the admin functionality between the two interfaces as deemed necessary, or to consolidate the functionality in one or the other.

Given the role of Wagtail CMS in this project, I was not keen to consolidate the functionality exclusively into the Django interface, so I instead opted for Wagtail.
#### What did I learn?
For the temperature and humidity logging, I opted for a Django-inherited model class as opposed to another `Page` class.  The reason for this being that the Page class obscures the intent for temp/hum logs.  Since I opted to go for a Django-based class and utilize that within Wagtail's admin interface, this meant overriding Wagtail's ModelAdmin (separate from Django's ModelAdmin).  Overriding the ModelAdmin's IndexView template was a relatively easy process, with a new directory created in api/templates/modeladmin/api/temphumrecord/index.html created from the default version.  This allowed me to display the relevant temperature information in an easy-to-use way.  While overriding the view, I utilized Wagtail's WMABaseView, which has a bunch of helpers that are common throughout all Wagtail views like meta_title, page_title, a context helper, and so on.
#### Next Steps
The next step will be to integrate [Django-Vue](https://github.com/maximdeclercq/django-vue) within my admin pages to eliminate Chart.js and to serve a responsive, reactive data dashboard to the user.

## GPT-2
[GPT-2](https://github.com/openai/gpt-2) is a language model used to generate text from a given "prefix" of n length.
### Web Scraping
The default dataset that GPT-2 is provided with is not an acceptable dataset for generating greenhouse-oriented SEO keyword content.  So, I had some work to do.  After compiling a list of some of the most popular greenhouse and nursery blogs in the United States, I then used Selenium to scrape roughly 15Mb worth of plaintext content from these blogs.  After cleaning the data up, I had a somewhat reliable dataset to train GPT-2 on to generate relevant content.  This model utilizes similar technology that is used to predict text on the iMessages app above the keyboard.
#### What did I learn?
GPT-2 is extremely powerful, but like any model, it is only as good as the data you provide to it.  This means not only having a robust dataset, but having a *clean* dataset as well.  In the process of scraping data, I learned how to better filter and record appropriate data, as well as exactly how important it is to have clean data (otherwise you get non-human readable output).  In addition, I learned about variance within the model using temperature and top_k, which will limit the "randomness" and number of tokens considered per input.
#### Next Steps
The next step will be to integrate my trained GPT-2 model into Wagtail's RichTextEditor by creating a plugin that extends the editor with a new toolbar button to provide ease-of-use to CMS users for blog content generation.

## Django Rest Framework
[Django Rest Framework](https://github.com/encode/django-rest-framework) is a powerful tool for quickly building out REST API's that interact with Django's ORM in a sanitized, authenticated way.  It comes with pre-existing views for your API endpoints as well.
### Temp/Hum Logging
I utilized DRF in this project to serve as simple endpoint for an ESP8266 calling home and transmitting data.  In my serializer, I cast the string input supplied by the ESP8266 to a float and store the value away.
#### What did I learn?
I learned how to sanitize and serialize unformatted data into a Django model.
#### Next Steps
The next step will be to add an authentication method, likely in the form of a secret key, that will ensure and validate that the API call is coming from the ESP8266 device.

## ESP8266
[ESP8266 Microprocessor](https://github.com/esp8266/Arduino) is a small, WiFi enabled microprocessor powered by C.  This chip is commonly embedded on development boards, in my case I used the [NodeMCU](https://github.com/nodemcu/nodemcu-firmware).
### Electronics
I utilized ArduinoJSON and a DHT22 temperature and humidity sensor to read and monitor temp/hum levels in a given location (greenhouse).  With ArduinoJSON, I POST a request containing the current temp/humidity every thirty minutes to Django Rest Framework's API endpoint /api/dht/publish.
#### What did I learn?
I learned how to interface with microelectronics and the DHT-22, how to interact with HTTP requests from the ESP8266, and how to package and POST JSON data to an API endpoint.
#### Next Steps
The next step, as noted above, will be to add a secret key that is posted alongside each POST of the temperature and humidity data.

## Snipcart
[Snipcart](https://snipcart.com) is a easy-to-use cart, storefront, and inventorying platform.
### Details
Snipcart can automatically populate their service based on your product/storefront webpage.  There simply needs to be the correct placement of tags and indicators to tell Snipcart what to look for.  After this is set up properly (see:  /home/templates/home/product.html) Snipcart will auto-populate relevant product data in their service.
#### What did I learn?
To be frank, not much other than about how to interact with Snipcart's, admittedly easy, interface.  It is well documented and explained, with an outdated but still useful [Wagtail specific demo](https://snipcart.com/blog/django-ecommerce-tutorial-wagtail-cms).
#### Next Steps
I will be scrapping Snipcart entirely in favor of a Stripe-based and native inventory management system.  I would like to make the inventorying system more robust to include in-store checkouts and an easy-to-use dashboard for tracking payments, orders, and stock.
